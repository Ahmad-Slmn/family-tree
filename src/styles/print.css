/* ========================= print.css — أنماط الطباعة ========================= */

/* طلب طباعة الألوان كما هي (عند الدعم) */
*{print-color-adjust:exact}

/* ====== وضع الطباعة ====== */
@media print{

  /* خلفية بيضاء للورق + إلغاء أي ظلال عامة */
  html,
  body{
    background:#fff !important;
    box-shadow:none !important;
    color:var(--text-main);
    overflow:visible !important;
  }

  /* في الطباعة: إلغاء الطيّ → كل الأقسام تُطبع مفتوحة */
  .wife-section-body,
  .wife-section-body.is-collapsed{
    display:block !important;
    max-height:none !important;
    overflow:visible !important;
  }

  /* في الطباعة: إخفاء رأس قسم الزوجة بالكامل (العنوان + زر الطيّ) */
  .wife-section-header{
    display:none !important;
  }


  /* إخفاء عناصر الواجهة التفاعلية التي لا داعي لها في الورق */
  #app-splash,
  .top-bar,
  #toastContainer,
  .modal,
  .confirm-modal,
  .form-modal,
  .side-toggle,
  #sideToggle,
  #sideOverlay,
  .side-overlay,
  #sidePanel,
  .side-panel,
  .scroll-buttons,
  .site-tagline,
  .site-title,
  #advFilters{
    display:none !important;
  }

  /* تهيئة رأس الصفحة في الطباعة */
  .site-header{
    max-width:60rem;
    margin:1rem auto .75rem !important;
    padding:1rem 1.5rem !important;
    text-align:center !important;
  }

  /* إبقاء اسم العائلة كرأس واضح في الطباعة */
  .site-subtitle{
    margin-top:1rem !important;
  }

  /* حماية العناوين من الانقسام بين الصفحات */
  h1,
  h2,
  h3,
  .section-title{
    break-after:avoid-page;
    page-break-after:avoid;
  }

  /* تحسين الصور داخل البطاقات مع الحفاظ على تصميمها */
  img{image-rendering:auto}
  .member-card img{
    max-width:100% !important;
    height:auto !important;
  }

  /* منع انقسام العناصر المناسبة بين الصفحات (بدون #familyTree) */
  .member-card,
  .wife-section,
  .generation,
  .wives-section{
    break-inside:avoid;
    page-break-inside:avoid;
  }
  .connector,
  .connector::before,
  .connector::after,
  .wife-connector,
  .wife-connector::after,
  .vertical-line,
  .child-line{
    visibility:hidden !important;
  }

  /* ================== خيارات الطباعة (تتحكم بها أصناف على الـ body) ================== */

  /* 1) وضع مبسّط – إخفاء الحقول الثانوية */
  body.print-compact .member-card .role,
  body.print-compact .member-card .dob,
  body.print-compact .member-card .counter-box,
  body.print-compact .member-card .mini-strip{
    display:none !important;
  }

  /* 2) إخفاء العدّادات فقط */
  body.print-hide-counters .member-card .counter-box{
    display:none !important;
  }

  /* 3) إخفاء الصور واستبدالها بأيقونة داخل نفس دائرة الأفتار */
  body.print-hide-photos .member-card .avatar[data-print-avatar]{
    position:relative;
  }
  body.print-hide-photos .member-card .avatar[data-print-avatar]::before{
    content:attr(data-print-avatar);
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:2.5rem;
    line-height:1;
  }
  body.print-hide-photos .member-card .avatar img{
    visibility:hidden !important; /* نحافظ على إطار الأفتار كما هو */
  }

  /* 4) إزالة الألوان (طباعة أبيض وأسود) */
  body.print-no-colors{
    filter:grayscale(1) !important;
  }

  /* 5) بطاقات الشجرة فقط: إظهار شجرة العائلة وحدها */
  body.print-cards-only *:not(#familyTree):not(#familyTree *){
    display:none !important;
  }
  body.print-cards-only #familyTree{
    display:block !important;
  }

  /* 6) كل زوجة في صفحة مستقلة تقريبًا */
  body.print-wife-per-page #familyTree>.generation:not(.wives-section)+.wives-section{
    page-break-before:always;
  }
  body.print-wife-per-page .wives-section .wife-section{
    page-break-before:always;
    break-inside:avoid;
    page-break-inside:avoid;
  }
  body.print-wife-per-page .wives-section .wife-section:first-child{
    page-break-before:auto;
  }

  /* 7) حجم خط أصغر للطباعة */
  body.print-small-font{
    font-size:.85rem;
  }
  
  /* 8) إخفاء مسمّيات القرابة (الدور) */
body.print-hide-roles .member-card .role{
  display:none !important;
}


}

/* ====== إعدادات الصفحة (A4 عموديًا) ====== */
@page{
  size:A4 portrait;
  margin:1.5cm;
}
