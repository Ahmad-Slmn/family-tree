/* ==========================================================================
   bio-sections.css
   أنماط مشتركة لجميع أقسام السيرة (stories/sources/education/timeline/career)
   ========================================================================== */

/* -----------------------------
   1) أساسيات القسم (Container)
   ----------------------------- */
.bio-section{
  margin-top:1rem;
  padding:1rem;
  background:linear-gradient(135deg,
    color-mix(in oklab,var(--panel-bg) 80%,#fff) 0%,
    var(--card-bg) 55%
  );
  border:1px solid color-mix(in oklab,var(--surface-border) 80%,transparent);
  border-radius:1rem;
  box-shadow:0 .3rem 1rem rgba(0,0,0,.06);
}

.bio-section>h3,
.biosec-section-title{
  margin:0 0 .55rem;
  font-size:1.02rem;
  font-weight:800;
  color:var(--title-color);
}

.biosec-meta{
  margin:-.15rem 0 .65rem;
  font-size:.8rem;
  line-height:1.8;
  color:color-mix(in oklab,var(--text-muted) 88%,var(--text-main));
  opacity:.98;
}

.biosec-count-badge{
  display:inline-flex;
  align-items:center;
  padding:.05rem .45rem;
  margin-inline-start:.35rem;
  font-size:.78rem;
  font-weight:500;
  border-radius:999px;
  background:color-mix(in oklab,var(--panel-bg) 92%,#fff);
  border:1px solid color-mix(in oklab,var(--surface-border) 75%,transparent);
  color:color-mix(in oklab,var(--text-muted) 80%,var(--text-main));
  box-shadow:0 .05rem .25rem rgba(0,0,0,.05);
}

/* -----------------------------
   2) أدوات القسم (Tools/Header)
   ----------------------------- */
.biosec-header{margin-bottom:.35rem}

.biosec-tools{
  width:100%;
  margin-bottom:1rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:.6rem;
  flex-wrap:wrap;
}

.biosec-tools-left,
.biosec-tools-right{
  display:flex;
  align-items:center;
  gap:1rem;
  flex-wrap:wrap;
}

.biosec-tools-left{
  flex:1 1 auto;
  justify-content:flex-start;
  gap:.5rem;
  min-width:0;
  overflow:hidden;

  /* سلاسة ثابتة بدون JS */
  max-height: 240px;           /* قيمة كبيرة تكفي للفلاتر */
  opacity:1;
  transform:translateY(0);
  transition:max-height .25s ease, opacity .2s ease, transform .25s ease;
  will-change:max-height, opacity, transform;
}

.biosec-tools-left.is-collapsed{
  max-height:0;
  opacity:0;
  transform:translateY(-6px);
}


.biosec-tools-right{
  flex:0 1 auto;
  width:auto;
  min-width:0;
  max-width:100%;
  margin-top:1rem;
}

.biosec-edit-block{margin-top:1rem}

.biosec-edit-block-title{color: var(--title-color); font-weight: bold}

/* -----------------------------
   3) حقول الإدخال المشتركة
   ----------------------------- */
:where(.biosec-input, .biosec-select, .biosec-sort, .biosec-type-filter),
.biosec-title-input,
.biosec-textarea,
.biosec-linked-sources-search,
.biosec-search-input{
  border:1px solid var(--surface-border);
  background:var(--panel-bg);
  color:var(--text-main);
  outline:none!important;
  transition:border-color .16s, box-shadow .16s, background-color .16s, transform .12s;
}

/* Hover موحّد لحقول الإدخال */
:where(.biosec-input, .biosec-select, .biosec-sort, .biosec-type-filter):hover,
.biosec-linked-sources-search:hover{
  border-color:color-mix(in oklab,var(--modal-primary) 40%,var(--surface-border));
  background:color-mix(in oklab,var(--panel-bg) 94%,#fff);
  transform:translateY(-1px);
  box-shadow:0 .12rem .32rem rgba(0,0,0,.06);
}

/* Focus موحّد */
:where(.biosec-input, .biosec-select, .biosec-sort, .biosec-type-filter):focus-visible,
.biosec-title-input:focus-visible,
.biosec-textarea:focus-visible,
.biosec-linked-sources-search:focus-visible,
.biosec-search-input:focus-visible{
  border-color:var(--modal-primary);
  box-shadow:0 0 0 .09rem color-mix(in oklab,var(--modal-primary) 40%,transparent);
  background:var(--card-bg);
}

/* -----------------------------
   4) البحث (Search)
   ----------------------------- */
.biosec-search-wrap{
  min-width:15rem;
  position:relative;
  display:flex;
  align-items:center;
}

.biosec-search-input{
  width:100%;
  min-width:18rem;
  padding:.35rem .9rem;
  padding-inline-end:2.2rem; /* منع تداخل النص مع أيقونة المسح */
  border-radius:.7rem;
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);
  font-size:.8rem;
}

.biosec-search-input::placeholder{
  color:color-mix(in oklab,var(--text-muted) 90%,var(--text-main));
}

.biosec-search-clear{
  position:absolute;
  inset-inline-end:.45rem;
  top:50%;
  transform:translateY(-50%);
  border:0;
  background:transparent;
  padding:.15rem;
  cursor:pointer;
  opacity:.85;
  color:color-mix(in oklab,var(--text-muted) 70%,var(--text-main));
}
.biosec-search-clear:hover{opacity:1}
.biosec-search-clear:focus-visible{
  outline:none;
  box-shadow:0 0 0 .09rem color-mix(in oklab,var(--modal-primary) 40%,transparent);
  border-radius:.4rem;
}

.biosec-linked-sources-search{
  border-radius: .65rem;
    min-width: 12rem;
    padding: .35rem .7rem;
    flex: 1 1 14rem;
}
/* -----------------------------
   5) الأزرار (Buttons)
   ----------------------------- */
.biosec-add-btn,
.biosec-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:.3rem;

  padding:.35rem .9rem;
  border-radius:.7rem;
  border:none;

  background:var(--modal-primary);
  color:var(--modal-primary-fg,var(--modal-fg));
  font-size:.9rem;
  font-weight:600;

  cursor:pointer;
  box-shadow:0 .18rem .45rem rgba(0,0,0,.16);
  transition:transform .12s, box-shadow .12s, background-color .18s, opacity .12s;
}
.biosec-add-btn:hover,
.biosec-btn:hover{
  transform:translateY(-1px);
  box-shadow:0 .28rem .7rem rgba(0,0,0,.18);
  background:color-mix(in oklab,var(--modal-primary) 88%,#fff);
}
.biosec-add-btn:active,
.biosec-btn:active{
  transform:translateY(0);
  box-shadow:0 .14rem .35rem rgba(0,0,0,.16);
  opacity:.9;
}

.biosec-filters-reset{margin-top:1.15rem}

/* -----------------------------
   6) القائمة/البطاقات/الحالة الفارغة
   ----------------------------- */
.biosec-list{display:flex;flex-direction:column;gap:.85rem}

.biosec-empty{
  padding:1rem 1.1rem;
  border-radius:.8rem;
  border:1px dashed color-mix(in oklab,var(--surface-border) 80%,transparent);
  background:color-mix(in oklab,var(--panel-bg) 88%,#fff);
  font-size:.9rem;
  color:color-mix(in oklab,var(--text-muted) 90%,var(--text-main));
  text-align:center;
}

.biosec-card{
  background:var(--card-bg);
  border-radius:.9rem;
  border:1px solid var(--surface-border);
  box-shadow:0 .22rem .7rem rgba(0,0,0,.05);

  padding:.8rem .9rem .85rem;
  display:flex;
  flex-direction:column;
  gap:.6rem;

  transition:box-shadow .16s, transform .16s, border-color .16s;

  max-height:20rem;
  overflow-y:auto;
}
.biosec-card:hover{
  border-color:color-mix(in oklab,var(--modal-primary) 40%,var(--surface-border));
  box-shadow:0 .32rem 1rem rgba(0,0,0,.08);
  transform:translateY(-1px);
}

/* تمييز الكارد عند القفز (داخل الحدود فقط لتفادي تمدد بصري) */
.biosec-card--jump-highlight{
  position:relative;
  outline:2px solid color-mix(in oklab,var(--modal-primary) 70%,#ffb400);
  outline-offset:0;
}
.biosec-card--jump-highlight::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;

  box-shadow:
    inset 0 0 0 4px color-mix(in oklab,var(--modal-primary) 22%,transparent),
    0 8px 24px rgba(0,0,0,.12);

  background:linear-gradient(90deg,
    color-mix(in oklab,var(--modal-primary) 16%,transparent),
    color-mix(in oklab,var(--modal-primary) 6%,transparent) 60%,
    transparent
  );

  animation:biosec-jump-pulse 1.4s ease-out;
}

/* منع تداخل hover transform مع تأثير القفز */
.biosec-card--jump-highlight,
.biosec-card--jump-highlight:hover{transform:none}

@keyframes biosec-jump-pulse{
  0%{
    box-shadow:0 0 0 0 color-mix(in oklab,var(--modal-primary) 35%,transparent), 0 0 0 rgba(0,0,0,0);
    background-color:color-mix(in oklab,var(--modal-primary) 18%,transparent);
  }
  60%{
    box-shadow:0 0 0 8px color-mix(in oklab,var(--modal-primary) 14%,transparent), 0 10px 26px rgba(0,0,0,.18);
  }
  100%{
    box-shadow:0 0 0 4px color-mix(in oklab,var(--modal-primary) 22%,transparent), 0 8px 24px rgba(0,0,0,.12);
    background-color:transparent;
  }
}

.biosec-card-top{display:flex;justify-content:space-between;align-items:center;gap:.5rem}

/* شارات أعلى البطاقة */
.biosec-card-index,
.biosec-pinned-badge{
  align-self:flex-start;
  font-size:.75rem;
  font-weight:700;
  color:var(--arrow-color);
  background:color-mix(in oklab,var(--arrow-color) 14%,transparent);
  border-radius:999px;
  padding:.1rem .6rem;
  border:1px solid color-mix(in oklab,var(--arrow-color) 45%,transparent);
  display:inline-flex;
  align-items:center;
  gap:.25rem;
}
.biosec-pinned-badge::before{content:"★";font-size:.85rem}

/* -----------------------------
   7) وضع المعاينة/التحرير
   ----------------------------- */
.biosec-preview{display:flex;flex-direction:column;gap:.25rem}
.biosec-preview-title{font-weight:700;font-size:.96rem;color:var(--title-color)}

.biosec-preview-meta{
  display:flex;
  flex-wrap:wrap;
  gap:.4rem;
  font-size:.78rem;
  color:var(--text-muted);
  margin:.1rem 0 .2rem;
}
.biosec-preview-meta span+span{position:relative;padding-inline-start:.75rem}
.biosec-preview-meta span+span::before{content:"•";position:absolute;inset-inline-start:.25rem;top:0}

.biosec-preview-text{
  margin:0;
  font-size:.9rem;
  white-space:pre-line;
  line-height:2;
  color:var(--text-main);
}

.biosec-edit{display:flex;flex-direction:column;gap:.5rem}
.biosec-card--preview .biosec-edit{display:none}
.biosec-card--edit .biosec-preview{display:none}

.biosec-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  flex-wrap:wrap;
  gap:.7rem;
}

.biosec-title-input{
  flex:1 1 auto;
  min-width:0;
  padding:.35rem .7rem;
  border-radius:.6rem;
  font-size:.92rem;
}
.biosec-title-input::placeholder{color:var(--text-muted)}

.biosec-dates{flex:0 0 auto;font-size:.8rem;color:var(--text-muted);white-space:nowrap}
.biosec-body{display:flex;flex-direction:column;gap:.45rem}

.biosec-textarea{
  width:100%;
  border-radius:.7rem;
  padding:.45rem .7rem;
  font-size:.9rem;
  resize:vertical;
}
.biosec-textarea::placeholder{color:var(--text-muted)}

/* بلوك ملاحظة داخل المعاينة */
.biosec-note-preview{
  margin-top:.35rem;
  padding:.35rem .55rem;
  border-radius:.65rem;
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);
  border:1px dashed color-mix(in oklab,var(--surface-border) 80%,transparent);
  font-size:.82rem;
  line-height:1.7;
  color:color-mix(in oklab,var(--text-muted) 85%,var(--text-main));
}
.biosec-note-preview strong{color:var(--title-color);font-weight:800}
.biosec-note-preview span{color:inherit}

/* -----------------------------
   8) الشارات + مؤشر طول النص
   ----------------------------- */
.biosec-preview-badges{display:flex;flex-wrap:wrap;gap:.3rem;margin:.1rem 0 .15rem}

.biosec-badge{
  display:inline-flex;
  align-items:center;
  padding:.06rem .5rem;
  border-radius:999px;
  font-size:.74rem;
  border:1px solid color-mix(in oklab,var(--surface-border) 80%,transparent);
  background:color-mix(in oklab,var(--panel-bg) 94%,#fff);
  color:color-mix(in oklab,var(--text-muted) 85%,var(--text-main));
}

.biosec-length-chip{
  display:inline-flex;
  align-items:center;
  gap:.3rem;
  padding:.04rem .45rem;
  border-radius:999px;
  background:color-mix(in oklab,var(--panel-bg) 95%,#fff);
  border:1px solid color-mix(in oklab,var(--surface-border) 80%,transparent);
}

.biosec-length-meter{
  width:2.75rem;
  height:.25rem;
  border-radius:999px;
  background:color-mix(in oklab,var(--panel-bg) 88%,#fff);
  overflow:hidden;
}
.biosec-length-meter-bar{display:block;height:100%;width:0;border-radius:999px;transform-origin:left center}
.biosec-length-meter[data-level="1"] .biosec-length-meter-bar{width:30%;background:color-mix(in oklab,var(--accent-success) 70%,#fff)}
.biosec-length-meter[data-level="2"] .biosec-length-meter-bar{width:65%;background:color-mix(in oklab,var(--arrow-color) 75%,#fff)}
.biosec-length-meter[data-level="3"] .biosec-length-meter-bar{width:100%;background:color-mix(in oklab,var(--modal-danger) 80%,#fff)}

/* -----------------------------
   9) Meta Row + Field Head
   ----------------------------- */
.biosec-meta-row{
  display:flex;
  flex-wrap:wrap;
  gap:.4rem;
  align-items:stretch;
  margin:.5rem 0;
}
.biosec-meta-row > *{flex:1 1 12rem;min-width:0}
.biosec-meta-row > :only-child{flex-basis:100%}

.biosec-field{
  display:flex;
  flex-direction:column;
  gap:.18rem;
  width:100%;
  margin:.30rem;
}

.biosec-field-head{
  display:flex;
  align-items:center;
  gap:.45rem;
  font-size:.78rem;
  color:color-mix(in oklab,var(--text-muted) 90%,var(--text-main));
  padding-inline:.1rem;
}
.biosec-field-icon{font-size:.85rem;opacity:.85}
.biosec-field-label{color:color-mix(in oklab,var(--text-muted) 78%,var(--text-main))}

.biosec-meta-field{display:flex;flex-direction:column;gap:.15rem;width:100%}
.biosec-meta-label,
.biosec-tool-label{
  font-size:.78rem;
  color:color-mix(in oklab,var(--text-muted) 90%,var(--text-main));
  display:flex;
  align-items:center;
  gap:.25rem;
}
.biosec-meta-icon{font-size:.8rem;opacity:.85}

/* حجم/شكل عناصر الإدخال العامة */
:where(.biosec-input, .biosec-select, .biosec-sort, .biosec-type-filter){
  min-width:10rem;
  padding:.32rem .65rem;
  border-radius:.6rem;
  font-size:.84rem;
  box-shadow:0 .06rem .18rem rgba(0,0,0,.03);
}

/* -----------------------------
   10) الوسائط المصغرة (صور/ملفات)
   ----------------------------- */
.biosec-images-block{display:flex;flex-direction:column;gap:.35rem}
.biosec-images-empty-hint{font-size:.8rem;color:color-mix(in oklab,var(--text-muted) 90%,var(--text-main))}
.biosec-images-row{
  display:flex;
  flex-wrap:wrap;
  justify-content:flex-end;
  gap:.35rem .4rem;
  margin-top:.35rem;
}
.biosec-images-thumbs{
  direction:ltr;
  display:flex;
  flex-wrap:wrap;
  gap:.4rem;
  max-width:100%;
  align-items:flex-start;
}

.biosec-image-thumb{
  position:relative;
  width:8rem;
  height:8rem;
  border-radius:.6rem;
  overflow:hidden;
  border:1px solid var(--surface-border);
  background:var(--panel-bg);
  box-shadow:0 .06rem .25rem rgba(0,0,0,.08);
  cursor:grab;
  transition:transform .14s ease-out, box-shadow .14s ease-out, border-color .14s ease-out, background-color .14s ease-out;
}
.biosec-image-thumb:active{cursor:grabbing}
.biosec-image-thumb img{width:100%;height:100%;object-fit:cover;display:block}

.biosec-image-thumb--drag{
  transform:scale(1.06) rotate(-1deg);
  box-shadow:0 .32rem 1rem rgba(0,0,0,.32);
  border-color:color-mix(in oklab,var(--modal-primary) 55%,var(--surface-border));
  background:color-mix(in oklab,var(--panel-bg) 88%,#fff);
  z-index:3;
}
.biosec-image-thumb--ghost{
  opacity:.45;
  transform:scale(.96);
  box-shadow:0 .06rem .2rem rgba(0,0,0,.12);
}

.biosec-image-thumb-view{
  position:absolute;
  inset-inline-start:.18rem;
  bottom:.18rem;
  padding:.05rem .35rem;
  border-radius:999px;
  border:none;
  background:rgba(0,0,0,.7);
  color:#fff;
  font-size:.65rem;
  line-height:1.2;
  cursor:pointer;
  box-shadow:0 .04rem .2rem rgba(0,0,0,.4);
}
.biosec-image-thumb-view:hover{background:rgba(0,0,0,.82)}

.biosec-image-thumb-remove{
  position:absolute;
  top:.18rem;
  inset-inline-end:.18rem;
  width:1.4rem;
  height:1.4rem;
  border-radius:999px;
  border:none;
  background:rgba(0,0,0,.58);
  color:#fff;
  font-size:.9rem;
  line-height:1;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0;
  box-shadow:0 .08rem .25rem rgba(0,0,0,.35);
}
.biosec-image-thumb-remove:hover{background:rgba(0,0,0,.8)}

/* عناصر ملف داخل الثمبنيل */
.biosec-file-thumb-footer{
  width:100%;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:.5rem;
  padding:.25rem .45rem;
  position:absolute;
  inset-inline:0;
  inset-block-end:0;
}
.biosec-file-thumb-view{
  padding:.18rem .65rem;
  font-size:.78rem;
  border:1px solid color-mix(in oklab,var(--surface-border) 80%,transparent);
}
.biosec-file-ext{
  position:absolute;
  inset-inline-end:.2rem;
  inset-block-end:.2rem;
  padding:.05rem .4rem;
  border-radius:.6rem;
  font-size:.68rem;
  background:rgba(0,0,0,.6);
  color:#fff;
  pointer-events:none;
}
.biosec-file-icon{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:2rem;
  color:var(--text-muted);
}
.biosec-file-label{
  display:block;
  text-align:center;
  font-size:.7rem;
  margin-top:.15rem;
  color:color-mix(in oklab,var(--text-muted) 90%,var(--text-main));
}

/* تقسيم صور/ملفات */
.biosec-files-group-title{
  width:100%;
  font-size:.78rem;
  font-weight:600;
  color:color-mix(in oklab,var(--text-muted) 88%,var(--text-main));
  margin:.15rem 0;
  padding-inline:.15rem;
}
.biosec-files-group-divider{
  width:100%;
  height:1px;
  background:color-mix(in oklab,var(--surface-border) 80%,transparent);
  margin:.35rem 0;
}
.biosec-files-slider-row{
  flex:0 0 100%;
  display:flex;
  justify-content:flex-start;
}

/* زر الشرائح */
.biosec-images-slider-btn{
  align-self:flex-start;
  margin-top:.25rem;
  padding:.18rem .7rem;
  border-radius:.7rem;
  border:1px solid color-mix(in oklab,var(--surface-border) 85%,transparent);
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);
  font-size:.8rem;
  cursor:pointer;
  color:color-mix(in oklab,var(--text-muted) 92%,var(--text-main));
  box-shadow:0 .04rem .16rem rgba(0,0,0,.06);
  transition:background-color .16s,border-color .16s,color .16s,transform .12s,box-shadow .12s;
}
.biosec-images-slider-btn:hover{
  background:color-mix(in oklab,var(--panel-bg) 92%,#fff);
  border-color:color-mix(in oklab,var(--surface-border) 70%,transparent);
  transform:translateY(-1px);
  box-shadow:0 .12rem .35rem rgba(0,0,0,.08);
}

/* -----------------------------
   11) الوسوم + زر القالب السريع
   ----------------------------- */
.biosec-tags-list{display:flex;flex-wrap:wrap;gap:.3rem;margin-top:.25rem}

.biosec-tag-chip,
.story-prompt-btn{
  padding:.06rem .5rem;
  border-radius:999px;
  font-size:.72rem;
  cursor:pointer;
  border:1px solid color-mix(in oklab,var(--surface-border) 80%,transparent);
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);
  color:color-mix(in oklab,var(--text-muted) 88%,var(--text-main));
  transition:background-color .14s,border-color .14s,color .14s,transform .1s;
}
.biosec-tag-chip:hover,
.story-prompt-btn:hover{
  background:color-mix(in oklab,var(--panel-bg) 90%,#fff);
  border-color:color-mix(in oklab,var(--modal-primary) 40%,var(--surface-border));
  transform:translateY(-1px);
}
.biosec-tag-chip.is-active,
.story-prompt-btn:active{
  background:color-mix(in oklab,var(--modal-primary) 88%,#fff);
  border-color:color-mix(in oklab,var(--modal-primary) 65%,var(--surface-border));
  color:var(--modal-primary-fg,var(--modal-fg));
}

/* -----------------------------
   12) صف التبديلات (Pin + Timeline)
   ----------------------------- */
.biosec-toggles-row{
  display:flex;
  flex-wrap:wrap;
  align-items:stretch;
  gap:.5rem;
  margin-top:.35rem;
}
.biosec-toggles-row .biosec-pin-toggle{margin-top:0}

/* زر تثبيت/تايملاين */
.biosec-pin-toggle{
  display:inline-flex;
  align-items:center;
  gap:.45rem;
  margin-top:.5rem;
  padding:.35rem .65rem;
  border-radius:.8rem;
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);
  border:1px dashed color-mix(in oklab,var(--surface-border) 85%,transparent);
  cursor:pointer;
  font-size:.86rem;
  color:color-mix(in oklab,var(--text-muted) 88%,var(--text-main));
  box-shadow:0 .06rem .2rem rgba(0,0,0,.03);
  transition:background-color .16s,border-color .16s,box-shadow .16s,transform .12s,color .14s;
}
.biosec-pin-toggle>input[type="checkbox"]{position:absolute;opacity:0;pointer-events:none}
.biosec-pin-toggle::before{
  content:"\f005";
  font-family:"Font Awesome 7 Free";
  font-weight:900;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:1.4rem;
  height:1.4rem;
  border-radius:999px;
  font-size:.85rem;
  line-height:1;
  background:color-mix(in oklab,var(--panel-bg) 90%,#fff);
  color:color-mix(in oklab,var(--text-muted) 88%,var(--text-main));
  box-shadow:0 .06rem .2rem rgba(0,0,0,.06);
  transition:background-color .16s,color .16s,transform .12s,box-shadow .12s;
}
.biosec-toggle--timeline:before{content:"\f254"}

.biosec-pin-toggle>span{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.biosec-pin-toggle:hover{
  background:color-mix(in oklab,var(--panel-bg) 92%,#fff);
  border-color:color-mix(in oklab,var(--modal-primary) 40%,var(--surface-border));
  transform:translateY(-1px);
  box-shadow:0 .12rem .35rem rgba(0,0,0,.08);
}
.biosec-pin-toggle:has(> input[type="checkbox"]:checked){
  background:color-mix(in oklab,var(--modal-primary) 14%,var(--panel-bg));
  border-style:solid;
  border-color:color-mix(in oklab,var(--modal-primary) 55%,transparent);
  color:color-mix(in oklab,var(--modal-primary) 40%,var(--text-main));
}
.biosec-pin-toggle:has(> input[type="checkbox"]:checked)::before{
  background:color-mix(in oklab,var(--arrow-color) 90%,#fff);
  color:color-mix(in oklab,var(--arrow-color) 40%,#000);
  box-shadow:0 .12rem .38rem rgba(0,0,0,.18);
  transform:scale(1.06);
}

/* -----------------------------
   13) Footer Buttons (Save/Cancel/Delete)
   ----------------------------- */
.biosec-footer{display:flex;justify-content:flex-end;gap:.45rem;margin-top:.25rem}

.biosec-save-btn,
.biosec-cancel-btn,
.biosec-delete-btn{
  min-width:4.2rem;
  padding:.28rem .8rem;
  border-radius:.7rem;
  border:1px solid transparent;
  font-size:.86rem;
  font-weight:600;
  cursor:pointer;
  transition:background-color .16s,border-color .16s,color .16s,transform .12s,box-shadow .12s;
}

.biosec-save-btn{
  background:var(--modal-primary);
  color:var(--modal-primary-fg,var(--modal-fg));
  box-shadow:0 .18rem .45rem rgba(0,0,0,.16);
}
.biosec-save-btn:hover{
  background:color-mix(in oklab,var(--modal-primary) 90%,#fff);
  transform:translateY(-1px);
  box-shadow:0 .26rem .75rem rgba(0,0,0,.18);
}
.biosec-save-btn:active{transform:translateY(0);box-shadow:0 .14rem .35rem rgba(0,0,0,.16)}

.biosec-delete-btn{
  background:transparent;
  color:var(--modal-danger);
  border-color:color-mix(in oklab,var(--modal-danger) 55%,transparent);
  box-shadow:0 .08rem .25rem rgba(0,0,0,.08);
}
.biosec-delete-btn:hover{background:color-mix(in oklab,var(--modal-danger) 10%,transparent)}

.biosec-cancel-btn{
  border-color:color-mix(in oklab,var(--surface-border) 90%,transparent);
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);
  color:color-mix(in oklab,var(--text-muted) 90%,var(--text-main));
  box-shadow:0 .06rem .2rem rgba(0,0,0,.04);
}
.biosec-cancel-btn:hover{
  background:color-mix(in oklab,var(--panel-bg) 92%,#fff);
  border-color:color-mix(in oklab,var(--surface-border) 70%,transparent);
  transform:translateY(-1px);
  box-shadow:0 .12rem .35rem rgba(0,0,0,.08);
}

/* -----------------------------
   14) حالات خاصة (Pinned)
   ----------------------------- */
.biosec-card--pinned{
  border-color:color-mix(in oklab,var(--modal-primary) 50%,var(--surface-border));
  background:color-mix(in oklab,var(--modal-primary) 6%,var(--card-bg));
  box-shadow:0 .28rem .9rem rgba(0,0,0,.09);
}
.biosec-card--pinned .biosec-card-index{
  background:color-mix(in oklab,var(--arrow-color) 18%,transparent);
}

/* -----------------------------
   15) linked sources (مشترك بين الأقسام)
   ----------------------------- */
.biosec-linked-sources{
  display:flex;
  flex-wrap:wrap;
  gap:.35rem;
  margin-top:.35rem;
  padding:.25rem .15rem;
  align-items:center;
}

.biosec-linked-sources-head{
  flex-basis:100%;
  display:flex;
  align-items:center;
  gap:.4rem;
  margin:.15rem 0 .05rem;
  font-size:.78rem;
  font-weight:700;
  color:color-mix(in oklab,var(--text-muted) 88%,var(--text-main));
}

.biosec-linked-sources-header{
  margin-top: .35rem;
    padding: .4rem .55rem;
    border-radius: .8rem;
    border: 1px solid color-mix(in oklab, var(--surface-border) 85%, transparent);
    background:  color-mix(in oklab, var(--panel-bg) 96%, #fff);
}

.biosec-linked-sources-title{
  display: flex;
    align-items: center;
    gap: .45rem;
    font-size: .86rem;
    font-weight: 650;
    color: var(--title-color);
}
/* Chips */
.biosec-chip.biosec-chip--source{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:.35rem;

  padding:.22rem .65rem;
  border-radius:999px;
  border:1px solid color-mix(in oklab,var(--surface-border) 85%,transparent);
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);

  font-size:.78rem;
  font-weight:700;
  line-height:1.2;

  color:color-mix(in oklab,var(--text-main) 92%,#000);
  cursor:pointer;

  transition:background-color .16s,border-color .16s,transform .12s,box-shadow .12s;
  box-shadow:0 .05rem .2rem rgba(0,0,0,.04);

  max-width:100%;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.biosec-chip.biosec-chip--source:hover{
  background:color-mix(in oklab,var(--panel-bg) 92%,#fff);
  border-color:color-mix(in oklab,var(--surface-border) 65%,transparent);
  transform:translateY(-1px);
  box-shadow:0 .12rem .35rem rgba(0,0,0,.08);
}
.biosec-chip.biosec-chip--source:focus-visible{
  outline:none;
  border-color:color-mix(in oklab,var(--modal-primary) 50%,var(--surface-border));
  box-shadow:0 0 0 .1rem color-mix(in oklab,var(--modal-primary) 35%,transparent),
             0 .12rem .35rem rgba(0,0,0,.08);
}
.biosec-chip.biosec-chip--source:active{
  transform:translateY(0);
  box-shadow:0 .06rem .2rem rgba(0,0,0,.06);
}
.biosec-chip.biosec-chip--source::before{
  content:"\f0c1";
  font-family:"Font Awesome 7 Free";
  font-weight:900;
  opacity:.75;
  font-size:.8em;
}

/* أدوات المصادر المرتبطة */
.biosec-linked-sources-tools{
  display:flex;
  align-items:center;
  gap:.45rem;
  margin-top:.35rem;
  flex-wrap:wrap;
}

.biosec-linked-sources-count{
  font-size:.78rem;
  padding:.18rem .55rem;
  border-radius:999px;
  border:1px solid var(--surface-border);
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);
  color:var(--text-muted);
}
.biosec-linked-sources-count[data-active="1"]{
  color:var(--text-main);
  border-color:color-mix(in oklab,var(--modal-primary) 40%,var(--surface-border));
  background:color-mix(in oklab,var(--modal-primary) 10%,var(--panel-bg));
}

.biosec-linked-sources-btn{
  border:0;
  background:color-mix(in oklab,var(--panel-bg) 95%,#fff);
  border-radius:999px;
  padding:.22rem .65rem;
  font-size:.78rem;
  cursor:pointer;
  color:var(--arrow-color);
  transition:background-color .16s ease,box-shadow .16s ease,transform .12s ease;
}
.biosec-linked-sources-btn:hover,
.biosec-linked-sources-btn:focus-visible{
  background:color-mix(in oklab,var(--accent-soft) 20%,#fff);
  transform:translateY(-1px);
  box-shadow:0 .08rem .24rem rgba(0,0,0,.1);
  outline:none;
}

.biosec-linked-sources-list{
  margin-top:.45rem;
  border:1px solid var(--surface-border);
  background:color-mix(in oklab,var(--panel-bg) 97%,#fff);
  border-radius:.85rem;
  padding:.45rem;
  width:fit-content;
  max-height:14rem;
  overflow:auto;

  display:flex;
  flex-wrap:wrap;
  gap:.35rem;
  align-items:stretch;
}

.biosec-linked-sources-row{
  position:relative;
  display:flex;
  align-items:flex-start;
  gap:.5rem;
  padding:.35rem .45rem;
  border-radius:.7rem;
  cursor:pointer;
  transition:background-color .14s ease,transform .12s ease;
  border:1px solid transparent;
}
.biosec-linked-sources-row:hover{
  background:color-mix(in oklab,var(--accent-soft) 14%,#fff);
  transform:translateY(-1px);
}

/* Checkbox مخصص */
.biosec-linked-sources-row input[type="checkbox"]{
  -webkit-appearance:none;
  appearance:none;
  margin:0;
  margin-top:.15rem;

  width:1.15rem;
  height:1.15rem;
  border-radius:.42rem;

  border:1px solid color-mix(in oklab,var(--surface-border) 80%,transparent);
  background:color-mix(in oklab,var(--panel-bg) 96%,#fff);

  display:inline-grid;
  place-items:center;

  box-shadow:0 .06rem .18rem rgba(0,0,0,.06);
  cursor:pointer;

  transition:background-color .16s,border-color .16s,transform .12s,box-shadow .16s;
}
.biosec-linked-sources-row:hover input[type="checkbox"]{
  border-color:color-mix(in oklab,var(--modal-primary) 40%,var(--surface-border));
  background:color-mix(in oklab,var(--panel-bg) 92%,#fff);
  transform:translateY(-1px);
  box-shadow:0 .12rem .35rem rgba(0,0,0,.08);
}
.biosec-linked-sources-row input[type="checkbox"]:focus-visible{
  outline:none;
  border-color:var(--modal-primary);
  box-shadow:0 0 0 .1rem color-mix(in oklab,var(--modal-primary) 35%,transparent),
             0 .12rem .35rem rgba(0,0,0,.08);
}
.biosec-linked-sources-row input[type="checkbox"]:checked{
  background:color-mix(in oklab,var(--modal-primary) 18%,#fff);
  border-color:color-mix(in oklab,var(--modal-primary) 55%,var(--surface-border));
  box-shadow:0 .14rem .42rem rgba(0,0,0,.10);
}
.biosec-linked-sources-row input[type="checkbox"]::after{
  content:"\f00c";
  font-family:"Font Awesome 7 Free";
  font-weight:900;
  font-size:.72rem;
  line-height:1;
  opacity:0;
  transform:scale(.85);
  color:color-mix(in oklab,var(--modal-primary) 85%,#000);
  transition:opacity .14s, transform .14s;
}
.biosec-linked-sources-row input[type="checkbox"]:checked::after{
  opacity:1;
  transform:scale(1);
}

.biosec-linked-sources-row:has(input[type="checkbox"]:checked){
  background:color-mix(in oklab,var(--modal-primary) 10%,#fff);
  border:1px solid color-mix(in oklab,var(--modal-primary) 35%,transparent);
}

.biosec-linked-sources-label{
  font-size:.85rem;
  font-weight: bold;
  line-height:1.35;
  word-break:break-word;
  color:var(--arrow-color);
}

/* -----------------------------
   16) الإستجابة Responsive
   ----------------------------- */

@media(max-width:29.9rem){
  .biosec-linked-sources-list{max-height:12.5rem}
  .biosec-linked-sources-row{flex:1 1 100%;min-width:100%}
  .biosec-linked-sources-search{flex:1 1 100%;min-width:100%}
}

/* شاشات صغيرة جدًا */
@media(max-width:23.9rem){
  .biosec-tools{flex-direction:column;align-items:stretch;gap:.4rem}
  .biosec-tools-left,.biosec-tools-right{width:100%;justify-content:space-between}

  .biosec-add-btn,.biosec-btn{width:100%;justify-content:center}
  .biosec-search-wrap{width:100%}

  .biosec-card{padding:.65rem .7rem .75rem;max-height:72vh}
  .biosec-head{flex-direction:column;align-items:stretch;gap:.45rem}
  .biosec-footer{flex-wrap:wrap;justify-content:stretch}
  .biosec-save-btn,.biosec-delete-btn,.biosec-cancel-btn{flex:1 1 auto;text-align:center}

  .biosec-meta-row > *{flex-basis:100%}

  /* ترتيب لوحة الفلاتر بعرض كامل */
  .biosec-tools-left{flex-direction:column;align-items:stretch}
  .biosec-tools-left > .biosec-tool-item,
  .biosec-tools-left > .biosec-tool-item > *{width:100%}
  :where(.biosec-input,.biosec-select,.biosec-sort,.biosec-type-filter){width:100%}
}

@media(min-width:24rem) and (max-width:29.9rem){
  .biosec-tools{flex-direction:column;align-items:stretch;gap:.45rem}
  .biosec-tools-left,.biosec-tools-right{width:100%;justify-content:space-between}
  .biosec-add-btn,.biosec-search-wrap,.biosec-btn{width:100%}
  .biosec-card{max-height:72vh}

  .biosec-meta-row > *{flex-basis:calc(50% - .2rem)}
  .biosec-meta-row > :last-child{flex-basis:100%}

  .biosec-tools-left{flex-direction:column;align-items:stretch}
  .biosec-tools-left > .biosec-tool-item,
  .biosec-tools-left > .biosec-tool-item > *{width:100%}
  :where(.biosec-input,.biosec-select,.biosec-sort,.biosec-type-filter){width:100%}
}

@media(min-width:30rem) and (max-width:39.9rem){
  .biosec-tools{flex-direction:column;align-items:stretch;gap:.5rem}
  .biosec-tools-left,.biosec-tools-right{width:100%}
  .biosec-tools-right{justify-content:space-between}

  .biosec-card{max-height:75vh}
  .biosec-head{flex-direction:column;align-items:stretch}
  .biosec-dates{text-align:start}
  .biosec-pin-toggle{width:100%}

  .biosec-meta-row > *{flex-basis:100%}

  .biosec-tools-left{flex-direction:column;align-items:stretch}
  .biosec-tools-left > .biosec-tool-item,
  .biosec-tools-left > .biosec-tool-item > *{width:100%}
  :where(.biosec-input,.biosec-select,.biosec-sort,.biosec-type-filter){width:100%}
  .biosec-chip.biosec-chip--source{max-width:100%}

}

@media(min-width:40rem) and (max-width:47.9rem){
  .biosec-tools{flex-direction:row;align-items:center;flex-wrap:wrap;gap:.5rem}
  .biosec-tools-left{flex:1 1 100%;justify-content:flex-start;gap:.5rem}
  .biosec-tools-right{flex:0 0 auto}

  .biosec-card{max-height:78vh}
  .biosec-head{flex-direction:row;align-items:center;gap:.6rem}
  .biosec-pin-toggle{width:auto}

  .biosec-meta-row > *{flex-basis:calc(50% - .2rem)}
}

@media(min-width:48rem) and (max-width:63.9rem){
  .biosec-card{max-height:22rem}
  .biosec-pin-toggle{width:auto}
}

@media(min-width:64rem){
  .biosec-card{max-height:24rem}
  .biosec-pin-toggle{width:auto}
}