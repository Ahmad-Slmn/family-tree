/* ================== base.css — الأساسيات العامة ================== */
/* ===================== Cairo Font (محلي) ===================== */
@font-face {
  font-family: 'Cairo';
  src: url('../assets/fonts/Cairo-Regular.ttf') format('truetype');
  font-weight: 400;
  font-display: swap;
}
@font-face {
  font-family: 'Cairo';
  src: url('../assets/fonts/Cairo-Bold.ttf') format('truetype');
  font-weight: 700;
  font-display: swap;
}

/* الخط الافتراضي العام */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Cairo', system-ui, -apple-system, sans-serif;
}

body {
  background: var(--bg-gradient);
  min-height: 100vh;
  color: var(--text-main);
  overflow-x: hidden;
}

:root{
  /* ===== z-index scale (من الأقل للأعلى) ===== */
  --z-base: 1;

  /* عناصر فوق المحتوى */
  --z-content: 10;

  /* قوائم/اقتراحات */
  --z-dropdown: 30;

  /* أزرار عائمة */
  --z-fab: 200;

  /* Scroll buttons */
  --z-scroll: 300;

  /* Overlay للشريط الجانبي */
  --z-side-overlay: 1098;
  --z-side-panel: 1099;
  --z-side-toggle: 1100;

  /* مودالات عامة/نماذج */
  --z-modal: 1100;
  --z-modal-inner: 1120;

  /* Splash loading */
  --z-splash: 1300;

  /* Toast أعلى شيء */
  --z-toast: 2001;

  /* Confirm modal لازم يكون فوق المودالات */
  --z-confirm: 2000;

  /* PIN lock أعلى شيء */
  --z-pin-lock: 3000;
  --z-pin-manage: 2990;
}


.container {
  max-width: 87.5rem;
  margin: 0 auto;
}

/* ===== غطاء التحميل (Splash) + البطاقة الداخلية ===== */

#app-splash[hidden] { display:none; }

#app-splash{
  position:fixed;
  inset:0;
 z-index:var(--z-splash);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:1.5rem;

  background:
    linear-gradient(
      to bottom,
      color-mix(in oklab,var(--modal-overlay,rgba(0,0,0,.8)) 65%,transparent),
      color-mix(in oklab,var(--modal-overlay,rgba(0,0,0,.8)) 80%,transparent)
    ),
    radial-gradient(
      circle at center,
      color-mix(in oklab,var(--modal-overlay,rgba(0,0,0,.8)) 0%,transparent) 0%,
      color-mix(in oklab,var(--modal-overlay,rgba(0,0,0,.8)) 70%,transparent) 100%
    ),
    image-set(
      url("../assets/images/background-family-tree-mobile-1x.webp") 1x,
      url("../assets/images/background-family-tree-mobile-2x.webp") 2x
    )
    center / cover no-repeat;

  backdrop-filter:blur(7px);
  -webkit-backdrop-filter:blur(7px);
  animation:splashFadeIn .35s ease-out;
}

/* ديسكتوب: صورة أكبر */
@media (min-width: 48rem){
  #app-splash{
    background:
      linear-gradient(
        to bottom,
        color-mix(in oklab,var(--modal-overlay,rgba(0,0,0,.8)) 65%,transparent),
        color-mix(in oklab,var(--modal-overlay,rgba(0,0,0,.8)) 80%,transparent)
      ),
      radial-gradient(
        circle at center,
        color-mix(in oklab,var(--modal-overlay,rgba(0,0,0,.8)) 0%,transparent) 0%,
        color-mix(in oklab,var(--modal-overlay,rgba(0,0,0,.8)) 70%,transparent) 100%
      ),
      image-set(
        url("../assets/images/background-family-tree-desktop-1x.webp") 1x,
        url("../assets/images/background-family-tree-desktop-2x.webp") 2x
      )
      center / cover no-repeat;
  }
}


/* خروج تدريجي للغطاء */
#app-splash.is-hiding{
  animation:splashFadeOut .4s ease-in forwards;
}

/* بطاقة التحميل */
.app-splash-card{
  position:relative;
  inline-size:clamp(17rem,70vw,26rem);
  padding:1.6rem 1.9rem 1.5rem;
  border-radius:1.35rem;
  background:linear-gradient(
    135deg,
    color-mix(in oklab,var(--card-bg,#fff) 94%,#fff),
    color-mix(in oklab,var(--panel-bg,var(--card-bg,#fff)) 92%,#fff)
  );
  box-shadow:
    0 .9rem 2.2rem color-mix(in oklab,#000 26%,transparent),
    0 0 0 .06rem color-mix(in oklab,var(--modal-fg,#111) 10%,transparent);
  text-align:center;
  overflow:hidden;
}

/* أحجام البطاقة حسب العرض */
@media (max-width:30rem){
  .app-splash-card{
    inline-size:100%;
    padding:1.3rem 1.4rem 1.2rem;
    border-radius:1.15rem;
  }
  .app-splash-title{font-size:.98rem;}
  .app-splash-subtitle{font-size:.78rem;}
}

@media (min-width:64rem){
  .app-splash-card{
    inline-size:28rem;
    padding:1.9rem 2.2rem 1.8rem;
  }
  .app-splash-title{font-size:1.15rem;}
}

/* لمسة ضوء متناسقة مع لون النجاح في الثيم */
.app-splash-card::before{
  content:"";
  position:absolute;
  inset:-35% -20% auto auto;
  background:radial-gradient(
    circle at top right,
    color-mix(in oklab,var(--accent-success,#16a34a) 32%,transparent) 0,
    transparent 58%
  );
  opacity:.9;
  pointer-events:none;
}

/* شعار العائلة */
.app-splash-logo{
  inline-size:3.5rem;
  block-size:3.5rem;
  margin:0 auto .9rem;
  border-radius:1.25rem;
  display:flex;
  align-items:center;
  justify-content:center;
  background:color-mix(in oklab,var(--card-bg,#fff) 96%,#000 4%);
  box-shadow:0 .4rem 1rem color-mix(in oklab,#000 22%,transparent);
  padding:.25rem;
}
.app-splash-logo img{
  inline-size:100%;
  block-size:100%;
  border-radius:1rem;
  object-fit:contain;
  display:block;
}

/* العنوان والنص */
.app-splash-title{
  font-size:1.05rem;
  font-weight:700;
  color:var(--title-color,var(--text-main,#111));
  margin-bottom:.2rem;
}
.app-splash-subtitle{
  font-size:.82rem;
  color:color-mix(in oklab,var(--text-main,#111) 68%,transparent);
  opacity:.95;
  line-height:1.6;
}

/* السبنر */
.app-splash-spinner{
  inline-size:2.7rem;
  block-size:2.7rem;
  margin:.95rem auto .6rem;
  border-radius:999px;
  border:.22rem solid color-mix(in oklab,var(--modal-fg,#111) 16%,transparent);
  border-top-color:var(--title-color,var(--text-main,#111));
  animation:spin 1s linear infinite;
}

/* شريط التقدّم */
.app-splash-progress{
  position:relative;
  inline-size:100%;
  max-inline-size:18rem;
  margin:.25rem auto 0;
  block-size:.32rem;
  border-radius:999px;
  background:color-mix(in oklab,var(--modal-fg,#111) 7%,transparent);
}
.app-splash-progress-bar{
  display:block;
  inline-size:0%;
  block-size:100%;
  border-radius:inherit;
  background:var(--title-color,var(--text-main,#111));
  transition:inline-size .35s ease-out;
}
.app-splash-progress-text{
  position:absolute;
  inset-block-start:-1.4rem;
  inset-inline-end:0;
  font-size:.78rem;
  color:color-mix(in oklab,var(--text-main,#111) 70%,transparent);
}

/* أزرار الـ Splash (Retry) */
.app-splash-actions{
  margin-top: .9rem;
  display:flex;
  justify-content:center;
  gap:.6rem;
}

#app-splash.has-error .app-splash-spinner{
  opacity:.35;
}

/* اختياري: لون الشريط/العنوان عند الخطأ */
#app-splash.has-error .app-splash-progress-bar{
  background: color-mix(in oklab, #ef4444 70%, var(--title-color,var(--text-main,#111)));
}
#app-splash.has-error .app-splash-title{
  color: color-mix(in oklab, #ef4444 60%, var(--title-color,var(--text-main,#111)));
}

/* دوران المؤشر */
@keyframes spin{
  to{transform:rotate(360deg);}
}

/* دخول الشجرة بعد الغطاء */
.family-tree-enter{
  opacity:0;
  transform:translateY(10px) scale(.97);
  animation:familyTreeIn .45s ease-out forwards;
}
@keyframes familyTreeIn{
  from{opacity:0;transform:translateY(10px) scale(.97);}
  to{opacity:1;transform:translateY(0) scale(1);}
}

/* دخول وخروج الغطاء */
@keyframes splashFadeIn{
  from{opacity:0;transform:translateY(6px);}
  to{opacity:1;transform:translateY(0);}
}
@keyframes splashFadeOut{
  from{opacity:1;transform:translateY(0);}
  to{opacity:0;transform:translateY(10px);}
}

/* ================== شريط التمرير ================== */
::-webkit-scrollbar{width:.75rem;height:.75rem}
::-webkit-scrollbar-track{background:var(--scroll-track);border-radius:.625rem}
::-webkit-scrollbar-thumb{
  background:var(--scroll-thumb);
  border-radius:.625rem;border:.125rem solid var(--scroll-track);
  opacity:.8;transition:background-color .3s,opacity .3s
}
::-webkit-scrollbar-thumb:hover{background:var(--scroll-thumb-hover);opacity:.6}

/* ================== التوست ================== */
/* الأساس */
#toastContainer{
  position:fixed;top:.75rem;left:50%;transform:translateX(-50%);
  z-index:var(--z-toast);display:flex;flex-direction:column;gap:.625rem;
  pointer-events:none;
}
.toast{
  display:flex;align-items:center;justify-content:center;gap:.75rem;
  min-width:18rem;max-width:25rem;padding:.75rem 1.25rem;
  border-radius:.625rem;font-weight:500;font-size:.875rem;
  box-shadow:0 .25rem 1rem rgba(0,0,0,.2);
  opacity:0;transform:translateY(-2rem);pointer-events:all;
  animation:slideIn .4s forwards,slideOut .4s 2.6s forwards;
}
.toast .icon{font-size:1.125rem}
.toast.success{background:var(--toast-success-bg);color:var(--toast-success-fg)}
.toast.error{background:var(--toast-error-bg);color:var(--toast-error-fg)}
.toast.info{background:var(--toast-info-bg);color:var(--toast-info-fg)}
.toast.warning{background:var(--toast-warning-bg);color:var(--toast-warning-fg)}
@keyframes slideIn{from{opacity:0;transform:translateY(-2rem)}to{opacity:1;transform:translateY(0)}}
@keyframes slideOut{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-2rem)}}

/* ================== الأزرار العامة ================== */
.btn{
  background:var(--ctl-bg);color:var(--ctl-fg);border:1px solid var(--ctl-border);
  padding:.55rem 1rem;border-radius:.5rem;font-weight:600;cursor:pointer;
  transition:transform .2s ease,background-color .2s ease,box-shadow .2s ease
}
.btn:hover{background:var(--ctl-hover-bg);transform:scale(1.04)}
.btn:active{background:var(--ctl-active-bg);transform:scale(0.98)}
.btn:focus-visible{outline:3px solid var(--ctl-ring);outline-offset:2px}
.btn:disabled,.btn[disabled]{opacity:.55;filter:grayscale(.15);cursor:not-allowed;transform:none}
.btn.small{padding:.4rem .7rem;font-size:.85rem}
.btn.tiny{padding:.35rem .5rem;border-radius:.5rem;background:var(--card-bg);color:var(--text-main);border:1px solid var(--surface-border)}
.btn.tiny:hover{background:color-mix(in srgb,var(--title-color) 12%,var(--card-bg))}
.btn.primary{background:var(--modal-primary);color:var(--modal-primary-fg);border-color:var(--modal-primary)}
.btn.primary:hover{background:var(--modal-primary-hover)}
.btn.cancel{background:var(--modal-secondary);color:var(--modal-secondary-fg);border-color:var(--modal-secondary)}
.btn.cancel:hover{background:var(--modal-secondary-hover)}
.btn.danger,.danger-btn{background:var(--modal-danger)!important;color:var(--modal-danger-fg)!important;border-color:var(--modal-danger)!important}
.btn.danger:hover,.danger-btn:hover{background:var(--modal-danger-hover)!important}
.danger-btn i{margin-inline-start:.25rem}
@media (prefers-reduced-motion:reduce){.btn{transition:none;transform:none!important}}

/* زر إغلاق عام (سيُعاد تعريفه داخل bio.css للمودال الخاص بالسيرة) */
.close-button{
  display:inline-flex;align-items:center;justify-content:center;width:2.25rem;height:2.25rem;
  border:.0625rem solid color-mix(in oklab,var(--modal-fg) 20%,transparent);border-radius:999px;background:transparent;cursor:pointer;
  transition:transform .12s,background-color .12s,border-color .12s;color:var(--modal-fg)
}
.close-button:hover{background:color-mix(in oklab,var(--modal-fg) 10%,transparent);transform:scale(1.04)}
.close-button:focus{outline:2px solid var(--title-color);outline-offset:2px}


/* ========== تركيز الوصول العام للأزرار ========== */
:where(button,[role="button"],.family-button,.theme-button):focus{outline:none !important}
:where(button,[role="button"],.family-button,.theme-button):focus-visible{
  outline:3px solid var(--focus-ring);outline-offset:2px !important;border-radius:.5rem !important
}

/* Utilities عامة */
[hidden]{display:none!important}

/* إخفاء وصفي لملصق select */
.visually-hidden{
  position:absolute!important;
  clip:rect(1px,1px,1px,1px);
  padding:0;border:0;height:1px;width:1px;overflow:hidden;
}

/* إخفاء زر المسح الأصلي للمتصفحات WebKit */
input[type="search"]::-webkit-search-cancel-button{ -webkit-appearance:none; }

/* الحاوية العامة لحقل + زر المسح */
.input-wrap{
  position: relative;
  display: flex;
  align-items: center;
}

/* أضف مساحة للزر داخل الحقل */
.input-wrap input{
  padding-inline-end: 2rem;
}



/* زر المسح العام */
.clear-btn{
  position: absolute;
  inset-inline-end: .5rem;
  inline-size: 1.75rem;
  block-size: 1.75rem;
  display: grid;
  place-items: center;
  background: transparent;
  border: 0;
  cursor: pointer;
  color: var(--ink, #333);
  opacity: .55;
  transition: opacity .15s ease;
}

.clear-btn:hover{ opacity: .95; }
.clear-btn:focus{
  outline: 2px solid color-mix(in oklab, var(--ink, #333) 40%, transparent);
  outline-offset: 2px;
}
.clear-btn[hidden]{ display: none !important; }

/* 1) ≤ 23.9rem */
@media (max-width:23.9rem){
  .btn,input,select{font-size:.8rem;padding:.4rem .6rem}
  #toastContainer{
    top:.5rem;left:0;right:0;transform:none;
    padding-inline:.5rem;align-items:stretch;
  }
  .toast{
    min-width:100%;max-width:100%;
    padding:.6rem .75rem;font-size:.8rem;border-radius:.5rem;
  }
}

/* 2) 24–29.9rem */
@media (min-width:24rem) and (max-width:29.9rem){
  #toastContainer{
    top:.6rem;left:50%;transform:translateX(-50%);
    padding-inline:.75rem;
  }
  .toast{
    min-width:16rem;max-width:20rem;
    padding:.65rem 1rem;font-size:.825rem;
  }
}

/* 3) 30–39.9rem */
@media (min-width:30rem) and (max-width:39.9rem){
  #toastContainer{
    top:.75rem;left:50%;transform:translateX(-50%);
    padding-inline:1rem;
  }
  .toast{
    min-width:17rem;max-width:22rem;font-size:.85rem;
  }
}

/* 4) 40–47.9rem */
@media (min-width:40rem) and (max-width:47.9rem){
  #toastContainer{
    top:.9rem;left:50%;transform:translateX(-50%);
  }
  .toast{
    min-width:18rem;max-width:24rem;
  }
}

/* 5) 48–63.9rem */
@media (min-width:48rem) and (max-width:63.9rem){
  #toastContainer{
    top:1rem;left:50%;transform:translateX(-50%);
  }
  .toast{
    min-width:18rem;max-width:25rem;
  }
}

/* 6) ≥ 64rem */
@media (min-width:64rem){
  #toastContainer{
    top:1rem;right:1.25rem;left:auto;
    transform:none;align-items:flex-end;
  }
  .toast{
    min-width:18rem;max-width:26rem;
  }
}